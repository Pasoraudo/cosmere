(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5761],{5761:(x,m,e)=>{"use strict";e.r(m),e.d(m,{NetworkModule:()=>_});var d=e(4521),S=e(2415),s=e(5e3),R=e(2846),p=e(5861),y=e(9976),u=e(7489),o=e(2860),t=e(5595),i=e(7749),a=e.n(i),n=e(340),r=e(4498),c=e(1993),l=e(5171),w=e(175),z=e(6579),X=e(9175),T=e(7327),U=e(9909);let g=(()=>{class h extends X.m1{constructor(){super({planets:[]}),this.planets$=this.select(f=>f.planets)}saveAllPlanets(f){(0,u.isEqual)(this.get().planets,f)||this.patchState(A=>({planets:(0,U.eG)(A.planets,f)}))}syncState(){return this.get()}syncPlanet(f){return(0,T.L)(f,this.get().planets)}reset(){this.patchState({planets:[]})}}return h.\u0275fac=function(f){return new(f||h)},h.\u0275prov=s.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"}),h})(),P=(()=>{class h{constructor(f,A){this.api=f,this.store=A}fetchAllPlanets(){var f=this;return(0,p.Z)(function*(){const A=yield f.api.get("planets");f.store.saveAllPlanets(A)})()}syncAllPlanets(){return this.store.syncState().planets}allPlanets(){return this.store.planets$}}return h.\u0275fac=function(f){return new(f||h)(s.LFG(z.S),s.LFG(g))},h.\u0275prov=s.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"}),h})();var E=e(4344),C=e(2285),N=e(5131);let M=(()=>{class h extends y.H{constructor(f,A,L,D,O,J,K){super(),this.characterApi=f,this.relationshipApi=A,this.formBuilder=L,this.bookApi=D,this.planetApi=O,this.modal=J,this.configurationApi=K,this.nodes=[],this.edges=[],this.characters=[],this.relationships=[]}ngOnInit(){var f=this;return(0,p.Z)(function*(){f.subscribe(f.characterApi.cosmereCharacters(),A=>{f.onCharactersChanges(A)}),f.subscribe(f.relationshipApi.cosmereRelationships(),A=>{f.onRelationshipsChanges(A)}),f.subscribe(f.configurationApi.configuration(),A=>f.onConfigurationChanges(A)),(0,u.defer)(()=>{f.characterApi.fetchAllCosmereCharacter(),f.relationshipApi.fetchAllCosmereRelationship()})})()}regenerateNetworkParameters(){this.edges=(0,o.U5)(this.filterRelationships(this.relationships));const f=new t.UndirectedGraph;(0,o.df)(this.relationships).forEach(D=>f.addNode(D)),this.filterRelationships(this.relationships).forEach(D=>f.addEdge(D.characterId1,D.characterId2));const L=a()(f,{rng:n("1231312"),resolution:2});this.nodes=(0,o.k$)(this.filterCharacters(this.characters),this.filterRelationships(this.relationships)).filter(D=>this.edges.map(O=>O.source).includes(D.id)||this.edges.map(O=>O.target).includes(D.id)),this.nodes=this.nodes.map(D=>Object.assign(Object.assign({},D),{group:L[D.id]})),this.edges=this.edges.map(D=>{const O=this.nodes.find(W=>W.id===D.target),J=this.nodes.find(W=>W.id===D.source);if(void 0===O||void 0===J)return D;const K=O.score>J.score?L[O.id]:L[J.id];return Object.assign(Object.assign({},D),{group:K})})}filterCharacters(f){return f}filterRelationships(f){let A=f;return this.configuration.books.length>0&&(A=A.filter(L=>this.configuration.books.includes(L.bookId))),A}onCharactersChanges(f){this.characters=f,this.regenerateNetworkParameters()}onRelationshipsChanges(f){this.relationships=f,this.regenerateNetworkParameters()}onConfigurationChanges(f){this.configuration=f,this.regenerateNetworkParameters()}}return h.\u0275fac=function(f){return new(f||h)(s.Y36(r.H),s.Y36(c.I),s.Y36(l.c),s.Y36(w.f),s.Y36(P),s.Y36(E.u),s.Y36(C.h))},h.\u0275cmp=s.Xpm({type:h,selectors:[["characters-relationships-graph"]],features:[s.qOj],decls:2,vars:2,consts:[[1,"relative","w-full","h-full","justify-center"],[3,"nodes","links"]],template:function(f,A){1&f&&(s.TgZ(0,"div",0),s._UZ(1,"d3-network",1),s.qZA()),2&f&&(s.xp6(1),s.Q6J("nodes",A.nodes)("links",A.edges))},directives:[N.J],encapsulation:2}),h})();const F=[{path:"",component:(()=>{class h extends S.n{constructor(){super()}ngOnInit(){}}return h.\u0275fac=function(f){return new(f||h)},h.\u0275cmp=s.Xpm({type:h,selectors:[["network"]],features:[s.qOj],decls:4,vars:0,consts:[[1,"inset-0","flex","flex-col","min-w-0","w-full","overflow-hidden"],[1,"flex","flex-row","h-full","grow","justify-center"],[1,"w-full"]],template:function(f,A){1&f&&(s.TgZ(0,"div",0),s._UZ(1,"configuration"),s.TgZ(2,"div",1),s._UZ(3,"characters-relationships-graph",2),s.qZA(),s.qZA())},directives:[R.B,M],encapsulation:2}),h})()}];var I=e(5804),B=e(7322),Y=e(4107),Z=e(9808),$=e(6767),H=e(3075),V=e(4613);let Q=(()=>{class h{}return h.\u0275fac=function(f){return new(f||h)},h.\u0275mod=s.oAB({type:h}),h.\u0275inj=s.cJS({imports:[[]]}),h})();var b=e(9373);let k=(()=>{class h{}return h.\u0275fac=function(f){return new(f||h)},h.\u0275mod=s.oAB({type:h}),h.\u0275inj=s.cJS({imports:[[I.J,B.lN,Y.LD,Z.ez,$.d,H.UX,V.m,Q,b.T]]}),h})();var q=e(393);let _=(()=>{class h{}return h.\u0275fac=function(f){return new(f||h)},h.\u0275mod=s.oAB({type:h}),h.\u0275inj=s.cJS({imports:[[d.Bz.forChild(F),k,q.ZD,I.J,V.m]]}),h})()},340:(x,m,e)=>{var d=e(9471),S=e(2992),s=e(7657),R=e(5583),p=e(1929),y=e(8083),u=e(3818);u.alea=d,u.xor128=S,u.xorwow=s,u.xorshift7=R,u.xor4096=p,u.tychei=y,x.exports=u},9471:function(x,m,e){var d;!function(S,s,R){function p(t){var i=this,a=function o(){var t=4022871197;return function(a){a=String(a);for(var n=0;n<a.length;n++){var r=.02519603282416938*(t+=a.charCodeAt(n));r-=t=r>>>0,t=(r*=t)>>>0,t+=4294967296*(r-=t)}return 2.3283064365386963e-10*(t>>>0)}}();i.next=function(){var n=2091639*i.s0+2.3283064365386963e-10*i.c;return i.s0=i.s1,i.s1=i.s2,i.s2=n-(i.c=0|n)},i.c=1,i.s0=a(" "),i.s1=a(" "),i.s2=a(" "),i.s0-=a(t),i.s0<0&&(i.s0+=1),i.s1-=a(t),i.s1<0&&(i.s1+=1),i.s2-=a(t),i.s2<0&&(i.s2+=1),a=null}function y(t,i){return i.c=t.c,i.s0=t.s0,i.s1=t.s1,i.s2=t.s2,i}function u(t,i){var a=new p(t),n=i&&i.state,r=a.next;return r.int32=function(){return 4294967296*a.next()|0},r.double=function(){return r()+11102230246251565e-32*(2097152*r()|0)},r.quick=r,n&&("object"==typeof n&&y(n,a),r.state=function(){return y(a,{})}),r}s&&s.exports?s.exports=u:e.amdD&&e.amdO?void 0!==(d=function(){return u}.call(m,e,m,s))&&(s.exports=d):this.alea=u}(0,x=e.nmd(x))},8083:function(x,m,e){var d;!function(S,s,R){function p(o){var t=this,i="";t.next=function(){var n=t.b,r=t.c,c=t.d,l=t.a;return n=n<<25^n>>>7^r,r=r-c|0,c=c<<24^c>>>8^l,l=l-n|0,t.b=n=n<<20^n>>>12^r,t.c=r=r-c|0,t.d=c<<16^r>>>16^l,t.a=l-n|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,o===Math.floor(o)?(t.a=o/4294967296|0,t.b=0|o):i+=o;for(var a=0;a<i.length+20;a++)t.b^=0|i.charCodeAt(a),t.next()}function y(o,t){return t.a=o.a,t.b=o.b,t.c=o.c,t.d=o.d,t}function u(o,t){var i=new p(o),a=t&&t.state,n=function(){return(i.next()>>>0)/4294967296};return n.double=function(){do{var l=((i.next()>>>11)+(i.next()>>>0)/4294967296)/(1<<21)}while(0===l);return l},n.int32=i.next,n.quick=n,a&&("object"==typeof a&&y(a,i),n.state=function(){return y(i,{})}),n}s&&s.exports?s.exports=u:e.amdD&&e.amdO?void 0!==(d=function(){return u}.call(m,e,m,s))&&(s.exports=d):this.tychei=u}(0,x=e.nmd(x))},2992:function(x,m,e){var d;!function(S,s,R){function p(o){var t=this,i="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var n=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^n^n>>>8},o===(0|o)?t.x=o:i+=o;for(var a=0;a<i.length+64;a++)t.x^=0|i.charCodeAt(a),t.next()}function y(o,t){return t.x=o.x,t.y=o.y,t.z=o.z,t.w=o.w,t}function u(o,t){var i=new p(o),a=t&&t.state,n=function(){return(i.next()>>>0)/4294967296};return n.double=function(){do{var l=((i.next()>>>11)+(i.next()>>>0)/4294967296)/(1<<21)}while(0===l);return l},n.int32=i.next,n.quick=n,a&&("object"==typeof a&&y(a,i),n.state=function(){return y(i,{})}),n}s&&s.exports?s.exports=u:e.amdD&&e.amdO?void 0!==(d=function(){return u}.call(m,e,m,s))&&(s.exports=d):this.xor128=u}(0,x=e.nmd(x))},1929:function(x,m,e){var d;!function(S,s,R){function p(o){var t=this;t.next=function(){var c,l,a=t.w,n=t.X,r=t.i;return t.w=a=a+1640531527|0,l=n[r+34&127],c=n[r=r+1&127],l^=l<<13,c^=c<<17,l=n[r]=(l^=l>>>15)^(c^=c>>>12),t.i=r,l+(a^a>>>16)|0},function i(a,n){var r,c,l,w,z,X=[],T=128;for(n===(0|n)?(c=n,n=null):(n+="\0",c=0,T=Math.max(T,n.length)),l=0,w=-32;w<T;++w)n&&(c^=n.charCodeAt((w+32)%n.length)),0===w&&(z=c),c^=c<<10,c^=c>>>15,c^=c<<4,c^=c>>>13,w>=0&&(l=0==(r=X[127&w]^=c+(z=z+1640531527|0))?l+1:0);for(l>=128&&(X[127&(n&&n.length||0)]=-1),l=127,w=512;w>0;--w)c=X[l+34&127],r=X[l=l+1&127],c^=c<<13,r^=r<<17,X[l]=(c^=c>>>15)^(r^=r>>>12);a.w=z,a.X=X,a.i=l}(t,o)}function y(o,t){return t.i=o.i,t.w=o.w,t.X=o.X.slice(),t}function u(o,t){null==o&&(o=+new Date);var i=new p(o),a=t&&t.state,n=function(){return(i.next()>>>0)/4294967296};return n.double=function(){do{var l=((i.next()>>>11)+(i.next()>>>0)/4294967296)/(1<<21)}while(0===l);return l},n.int32=i.next,n.quick=n,a&&(a.X&&y(a,i),n.state=function(){return y(i,{})}),n}s&&s.exports?s.exports=u:e.amdD&&e.amdO?void 0!==(d=function(){return u}.call(m,e,m,s))&&(s.exports=d):this.xor4096=u}(0,x=e.nmd(x))},5583:function(x,m,e){var d;!function(S,s,R){function p(o){var t=this;t.next=function(){var r,c,a=t.x,n=t.i;return r=a[n],c=(r^=r>>>7)^r<<24,c^=(r=a[n+1&7])^r>>>10,c^=(r=a[n+3&7])^r>>>3,c^=(r=a[n+4&7])^r<<7,r=a[n+7&7],a[n]=c^=(r^=r<<13)^r<<9,t.i=n+1&7,c},function i(a,n){var r,l=[];if(n===(0|n))l[0]=n;else for(n=""+n,r=0;r<n.length;++r)l[7&r]=l[7&r]<<15^n.charCodeAt(r)+l[r+1&7]<<13;for(;l.length<8;)l.push(0);for(r=0;r<8&&0===l[r];++r);for(8==r&&(l[7]=-1),a.x=l,a.i=0,r=256;r>0;--r)a.next()}(t,o)}function y(o,t){return t.x=o.x.slice(),t.i=o.i,t}function u(o,t){null==o&&(o=+new Date);var i=new p(o),a=t&&t.state,n=function(){return(i.next()>>>0)/4294967296};return n.double=function(){do{var l=((i.next()>>>11)+(i.next()>>>0)/4294967296)/(1<<21)}while(0===l);return l},n.int32=i.next,n.quick=n,a&&(a.x&&y(a,i),n.state=function(){return y(i,{})}),n}s&&s.exports?s.exports=u:e.amdD&&e.amdO?void 0!==(d=function(){return u}.call(m,e,m,s))&&(s.exports=d):this.xorshift7=u}(0,x=e.nmd(x))},7657:function(x,m,e){var d;!function(S,s,R){function p(o){var t=this,i="";t.next=function(){var n=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^n^n<<1)|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,o===(0|o)?t.x=o:i+=o;for(var a=0;a<i.length+64;a++)t.x^=0|i.charCodeAt(a),a==i.length&&(t.d=t.x<<10^t.x>>>4),t.next()}function y(o,t){return t.x=o.x,t.y=o.y,t.z=o.z,t.w=o.w,t.v=o.v,t.d=o.d,t}function u(o,t){var i=new p(o),a=t&&t.state,n=function(){return(i.next()>>>0)/4294967296};return n.double=function(){do{var l=((i.next()>>>11)+(i.next()>>>0)/4294967296)/(1<<21)}while(0===l);return l},n.int32=i.next,n.quick=n,a&&("object"==typeof a&&y(a,i),n.state=function(){return y(i,{})}),n}s&&s.exports?s.exports=u:e.amdD&&e.amdO?void 0!==(d=function(){return u}.call(m,e,m,s))&&(s.exports=d):this.xorwow=u}(0,x=e.nmd(x))},3818:function(x,m,e){var d;!function(S,s,R){var r,p=256,t=R.pow(p,6),i=R.pow(2,52),a=2*i,n=255;function c(v,g,P){var E=[],C=X(z((g=1==g?{entropy:!0}:g||{}).entropy?[v,U(s)]:null==v?function T(){try{var v;return r&&(v=r.randomBytes)?v=v(p):(v=new Uint8Array(p),(S.crypto||S.msCrypto).getRandomValues(v)),U(v)}catch(E){var g=S.navigator,P=g&&g.plugins;return[+new Date,S,P,S.screen,U(s)]}}():v,3),E),N=new l(E),M=function(){for(var G=N.g(6),F=t,I=0;G<i;)G=(G+I)*p,F*=p,I=N.g(1);for(;G>=a;)G/=2,F/=2,I>>>=1;return(G+I)/F};return M.int32=function(){return 0|N.g(4)},M.quick=function(){return N.g(4)/4294967296},M.double=M,X(U(N.S),s),(g.pass||P||function(G,F,I,B){return B&&(B.S&&w(B,N),G.state=function(){return w(N,{})}),I?(R.random=G,F):G})(M,C,"global"in g?g.global:this==R,g.state)}function l(v){var g,P=v.length,E=this,C=0,N=E.i=E.j=0,M=E.S=[];for(P||(v=[P++]);C<p;)M[C]=C++;for(C=0;C<p;C++)M[C]=M[N=n&N+v[C%P]+(g=M[C])],M[N]=g;(E.g=function(G){for(var F,I=0,B=E.i,Y=E.j,Z=E.S;G--;)F=Z[B=n&B+1],I=I*p+Z[n&(Z[B]=Z[Y=n&Y+F])+(Z[Y]=F)];return E.i=B,E.j=Y,I})(p)}function w(v,g){return g.i=v.i,g.j=v.j,g.S=v.S.slice(),g}function z(v,g){var C,P=[],E=typeof v;if(g&&"object"==E)for(C in v)try{P.push(z(v[C],g-1))}catch(N){}return P.length?P:"string"==E?v:v+"\0"}function X(v,g){for(var E,P=v+"",C=0;C<P.length;)g[n&C]=n&(E^=19*g[n&C])+P.charCodeAt(C++);return U(g)}function U(v){return String.fromCharCode.apply(0,v)}if(X(R.random(),s),x.exports){x.exports=c;try{r=e(5042)}catch(v){}}else void 0!==(d=function(){return c}.call(m,e,m,x))&&(x.exports=d)}("undefined"!=typeof self?self:this,[],Math)},5042:()=>{}}]);