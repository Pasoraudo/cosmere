(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5014],{9287:(G,F,x)=>{"use strict";x.d(F,{J:()=>d});var O=x(9976),M=x(6479),p=x(9268),u=x(1512),l=x(5e3);let d=(()=>{class v extends O.H{constructor(){super(),this.nodes=[],this.links=[],this.width=window.screen.availWidth,this.height=window.screen.availHeight,this.characterLinks=[],this.defaultOptions={zoom:!0},this.id=(0,p.V)(),this.groups=[]}ngOnChanges(e){this.nodes.length>0&&this.links.length>0&&this.create()}ngAfterViewInit(){this.nodes.length>0&&this.links.length>0&&this.create()}create(){this.options=Object.assign(Object.assign({},this.defaultOptions),this.options),this.element=document.getElementById(this.id+"-network"),M.Ys(this.element).selectChildren().remove(),this.createCharacterLinks(),this.initializeColor(),this.createSvg(),this.createLink(),this.createSimulation(),this.createNode()}initializeColor(){this.groups=Array.from(new Set(this.characterLinks.map(e=>e.group))),this.color=M.PKp(this.groups,M.Cn1)}createCharacterLinks(){const e=this.nodes.map(s=>s.id);this.characterLinks=this.links.filter(s=>e.includes(s.source)&&e.includes(s.target))}createSimulation(){this.simulation=M.A4v(this.nodes).force("link",M.Fsl(this.characterLinks).distance(20).id(this.getId)).force("charge",M.q5i().strength(e=>-200*e.score)).force("center",M.wqt(this.width/2,this.height/2)).force("radius",M.Hh(e=>e.score+20)).force("cluster",this.cluster(this.nodes)).on("tick",()=>{this.link.attr("d",this.linkArc),this.node.attr("transform",e=>`translate(${e.x}, ${e.y})`),(0,u.g)(200)})}createSvg(){const e=this;this.svg=M.Ue8("svg").attr("viewBox",[0,0,this.width,this.height]).style("font","12px sans-serif"),this.g=this.svg.append("g"),this.options.zoom&&this.svg.call(M.sPX().extent([[0,0],[this.width,this.height]]).on("zoom",function s({transform:r}){e.g.attr("transform",r)})),this.element.append(this.svg.node()),this.svg.attr("width",this.width).attr("height",this.height),this.svg.append("defs").selectAll("marker").data(this.groups).join("marker").attr("id",r=>`arrow-${r}`).attr("viewBox","0 -5 10 10").attr("refX",15).attr("refY",-.5).attr("markerWidth",6).attr("markerHeight",6).attr("orient","auto").append("path").attr("fill",this.color).attr("d","M0,-5L10,0L0,5")}createLink(){this.link=this.g.append("g").attr("fill","none").attr("stroke-width",1.5).selectAll("path").data(this.characterLinks).join("path").attr("stroke",e=>this.color(e.group))}createNode(){this.node=this.g.append("g").attr("fill","currentColor").attr("stroke-linecap","round").attr("stroke-linejoin","round").selectAll("g").data(this.nodes).join("g").call(this.drag(this.simulation)),this.node.append("circle").attr("stroke","black").attr("stroke-width",1).attr("r",e=>e.score).style("fill",e=>this.color(e.group)),this.node.append("text").text(e=>e.label).style("font-size","1rem").style("color","white").style("text-anchor","middle").style("dominant-baseline","central")}getId(e){return e.id}linkArc(e){const s=Math.hypot(e.target.x-e.source.x,e.target.y-e.source.y);return`\n    M${e.source.x},${e.source.y}\n    A${s},${s} 0 0,1 ${e.target.x},${e.target.y}\n  `}drag(e){return M.ohM().on("start",function s(i,c){i.active||e.alphaTarget(.3).restart(),c.fx=c.x,c.fy=c.y}).on("drag",function r(i,c){c.fx=i.x,c.fy=i.y}).on("end",function n(i,c){i.active||e.alphaTarget(0),c.fx=null,c.fy=null})}cluster(e){return function r(n){for(const i of e){const c=e.filter(g=>g.group===i.group),f=c.reduce((g,a)=>g+a.x,0)/c.length,E=c.reduce((g,a)=>g+a.y,0)/c.length;i.vx+=(f-i.x)*n*.2,i.vy+=(E-i.y)*n*.2}}}}return v.\u0275fac=function(e){return new(e||v)},v.\u0275cmp=l.Xpm({type:v,selectors:[["d3-network"]],inputs:{nodes:"nodes",links:"links",options:"options",width:"width",height:"height"},features:[l.qOj,l.TTD],decls:1,vars:1,consts:[[1,"flex","flex-1",3,"id"]],template:function(e,s){1&e&&l._UZ(0,"div",0),2&e&&l.MGl("id","",s.id,"-network")},encapsulation:2}),v})()},4498:(G,F,x)=>{"use strict";x.d(F,{H:()=>n});var O=x(5861),M=x(4004),u=x(5e3),l=x(6579),d=x(9175),v=x(7327),t=x(7489),e=x(9909);let r=(()=>{class i extends d.m1{constructor(){super({characters:[]}),this.characters$=this.select(f=>f.characters)}saveAllCharacters(f){(0,t.isEqual)(this.get().characters,f)||this.patchState(E=>({characters:(0,e.eG)(E.characters,f)}))}syncState(){return this.get()}syncCharacter(f){return(0,v.L)(f,this.get().characters)}reset(){this.patchState({characters:[]})}}return i.\u0275fac=function(f){return new(f||i)},i.\u0275prov=u.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),n=(()=>{class i{constructor(f,E){this.api=f,this.store=E}fetchAllCharacter(){var f=this;return(0,O.Z)(function*(){const E=yield f.api.get("characters");f.store.saveAllCharacters(E)})()}fetchAllCosmereCharacter(){var f=this;return(0,O.Z)(function*(){const g=(yield f.api.get("characters")).filter(a=>["Roshar","Yolen","Scadrial","Nalthis"].includes(a.planet));f.store.saveAllCharacters(g)})()}syncAllCharacters(){return this.store.syncState().characters}allCharacters(){return this.store.characters$}cosmereCharacters(){return this.store.characters$.pipe((0,M.U)(f=>f.filter(E=>["Roshar","Yolen","Scadrial","Nalthis"].includes(E.planet))))}}return i.\u0275fac=function(f){return new(f||i)(u.LFG(l.S),u.LFG(r))},i.\u0275prov=u.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})()},7749:(G,F,x)=>{var O=x(8487),M=x(6714),p=x(5568),u=x(8090),l=x(5766),d=x(8859).createRandomIndex,v=x(6956),t=v.UndirectedLouvainIndex,e=v.DirectedLouvainIndex,s={nodeCommunityAttribute:"community",getEdgeWeight:"weight",fastLocalMoves:!0,randomWalk:!0,resolution:1,rng:Math.random};function r(a,W,h){var o=a.get(W);void 0===o&&(o=0),a.set(W,o+=h)}function i(a,W,h,o,j){return Math.abs(o-j)<1e-10?a!==W&&h>a:o>j}function c(a,W,h){var y,w,k,b,$,K,U,T,N,I,B,z,P,D,S,L,Z,Q,o=new t(W,{getEdgeWeight:h.getEdgeWeight,keepDendrogram:a,resolution:h.resolution}),j=d(h.rng),m=!0,A=!0,C=new u(Float64Array,o.C),V=0,X=0,H=[];for(h.fastLocalMoves&&(k=new l(o.C));m;){if(z=o.C,m=!1,A=!0,h.fastLocalMoves){for(Q=0,T=h.randomWalk?j(z):0,N=0;N<z;N++,T++)k.enqueue(I=T%z);for(;0!==k.size;){for(I=k.dequeue(),X++,P=0,C.clear(),y=o.belongings[I],b=o.starts[I],$=o.starts[I+1];b<$;b++)P+=K=o.weights[b],r(C,w=o.belongings[B=o.neighborhood[b]],K);for(S=o.fastDeltaWithOwnCommunity(I,P,C.get(y)||0,y),D=y,U=0;U<C.size;U++)(w=C.dense[U])!==y&&(V++,i(D,y,w,L=o.fastDelta(I,P,C.vals[U],w),S)&&(S=L,D=w));if(S<0){if((D=o.isolate(I,P))===y)continue}else{if(D===y)continue;o.move(I,P,D)}for(m=!0,Q++,b=o.starts[I],$=o.starts[I+1];b<$;b++)(w=o.belongings[B=o.neighborhood[b]])!==D&&k.enqueue(B)}H.push(Q)}else for(H.push(Z=[]);A;){for(A=!1,Q=0,T=h.randomWalk?j(z):0,N=0;N<z;N++,T++){for(I=T%z,X++,P=0,C.clear(),y=o.belongings[I],b=o.starts[I],$=o.starts[I+1];b<$;b++)P+=K=o.weights[b],r(C,w=o.belongings[B=o.neighborhood[b]],K);for(S=o.fastDeltaWithOwnCommunity(I,P,C.get(y)||0,y),D=y,U=0;U<C.size;U++)(w=C.dense[U])!==y&&(V++,i(D,y,w,L=o.fastDelta(I,P,C.vals[U],w),S)&&(S=L,D=w));if(S<0){if((D=o.isolate(I,P))===y)continue}else{if(D===y)continue;o.move(I,P,D)}A=!0,Q++}Z.push(Q),m=A||m}m&&o.zoomOut()}return{index:o,deltaComputations:V,nodesVisited:X,moves:H}}function f(a,W,h){var y,w,k,b,$,K,T,N,I,B,z,P,R,D,S,L,V,H,_,J,o=new e(W,{getEdgeWeight:h.getEdgeWeight,keepDendrogram:a,resolution:h.resolution}),j=d(h.rng),m=!0,A=!0,C=new u(Float64Array,o.C),Z=0,Q=0,q=[];for(h.fastLocalMoves&&(k=new l(o.C));m;){if(R=o.C,m=!1,A=!0,h.fastLocalMoves){for(J=0,I=h.randomWalk?j(R):0,B=0;B<R;B++,I++)k.enqueue(z=I%R);for(;0!==k.size;){for(z=k.dequeue(),Q++,D=0,S=0,C.clear(),y=o.belongings[z],b=o.starts[z],$=o.starts[z+1],K=o.offsets[z];b<$;b++)T=o.weights[b],b<K?S+=T:D+=T,r(C,w=o.belongings[P=o.neighborhood[b]],T);for(V=o.deltaWithOwnCommunity(z,D,S,C.get(y)||0,y),L=y,N=0;N<C.size;N++)(w=C.dense[N])!==y&&(Z++,i(L,y,w,H=o.delta(z,D,S,C.vals[N],w),V)&&(V=H,L=w));if(V<0){if((L=o.isolate(z,D,S))===y)continue}else{if(L===y)continue;o.move(z,D,S,L)}for(m=!0,J++,b=o.starts[z],$=o.starts[z+1];b<$;b++)(w=o.belongings[P=o.neighborhood[b]])!==L&&k.enqueue(P)}q.push(J)}else for(q.push(_=[]);A;){for(A=!1,J=0,I=h.randomWalk?j(R):0,B=0;B<R;B++,I++){for(z=I%R,Q++,D=0,S=0,C.clear(),y=o.belongings[z],b=o.starts[z],$=o.starts[z+1],K=o.offsets[z];b<$;b++)T=o.weights[b],b<K?S+=T:D+=T,r(C,w=o.belongings[P=o.neighborhood[b]],T);for(V=o.deltaWithOwnCommunity(z,D,S,C.get(y)||0,y),L=y,N=0;N<C.size;N++)(w=C.dense[N])!==y&&(Z++,i(L,y,w,H=o.delta(z,D,S,C.vals[N],w),V)&&(V=H,L=w));if(V<0){if((L=o.isolate(z,D,S))===y)continue}else{if(L===y)continue;o.move(z,D,S,L)}A=!0,J++}_.push(J),m=A||m}m&&o.zoomOut()}return{index:o,deltaComputations:Z,nodesVisited:Q,moves:q}}function E(a,W,h,o){if(!M(h))throw new Error("graphology-communities-louvain: the given graph is not a valid graphology instance.");var j=p(h);if("mixed"===j)throw new Error("graphology-communities-louvain: cannot run the algorithm on a true mixed graph.");o=O(o,s);var m=0;if(0===h.size){if(a)return void h.forEachNode(function(b){h.setNodeAttribute(b,o.nodeCommunityAttribute,m++)});var A={};return h.forEachNode(function(b){A[b]=m++}),W?{communities:A,count:h.order,deltaComputations:0,dendrogram:null,level:0,modularity:NaN,moves:null,nodesVisited:0,resolution:o.resolution}:A}var w=("undirected"===j?c:f)(W,h,o),C=w.index;if(!W)return a?void C.assign(o.nodeCommunityAttribute):C.collect();var k={count:C.C,deltaComputations:w.deltaComputations,dendrogram:C.dendrogram,level:C.level,modularity:C.modularity(),moves:w.moves,nodesVisited:w.nodesVisited,resolution:o.resolution};return a?(C.assign(o.nodeCommunityAttribute),k):(k.communities=C.collect(),k)}var g=E.bind(null,!1,!1);g.assign=E.bind(null,!0,!1),g.detailed=E.bind(null,!1,!0),g.defaults=s,G.exports=g},6956:(G,F,x)=>{var O=x(6116),M=x(8487),p=x(2954).Q6,u=Symbol.for("nodejs.util.inspect.custom"),l={getEdgeWeight:"weight",keepDendrogram:!1,resolution:1};function d(t,e){var s=(e=M(e,l)).resolution,r=p(e.getEdgeWeight).fromEntry,n=2*(t.size-t.selfLoopCount),i=O.getPointerArray(n),c=O.getPointerArray(t.order+1),f=e.getEdgeWeight?Float64Array:O.getPointerArray(2*t.size);this.C=t.order,this.M=0,this.E=n,this.U=0,this.resolution=s,this.level=0,this.graph=t,this.nodes=new Array(t.order),this.keepDendrogram=e.keepDendrogram,this.neighborhood=new c(n),this.weights=new f(n),this.loops=new f(t.order),this.starts=new i(t.order+1),this.belongings=new c(t.order),this.dendrogram=[],this.mapping=null,this.counts=new c(t.order),this.unused=new c(t.order),this.totalWeights=new f(t.order);var g,E={},a=0,W=0,h=this;t.forEachNode(function(o){h.nodes[a]=o,E[o]=a,W+=t.undirectedDegreeWithoutSelfLoops(o),h.starts[a]=W,h.belongings[a]=a,h.counts[a]=1,a++}),t.forEachEdge(function(o,j,m,A,y,w,C){if(g=r(o,j,m,A,y,w,C),m=E[m],A=E[A],h.M+=g,m===A)h.totalWeights[m]+=2*g,h.loops[m]=2*g;else{h.totalWeights[m]+=g,h.totalWeights[A]+=g;var k=--h.starts[m],b=--h.starts[A];h.neighborhood[k]=A,h.neighborhood[b]=m,h.weights[k]=g,h.weights[b]=g}}),this.starts[a]=this.E,this.keepDendrogram?this.dendrogram.push(this.belongings.slice()):this.mapping=this.belongings.slice()}function v(t,e){var s=(e=M(e,l)).resolution,r=p(e.getEdgeWeight).fromEntry,n=2*(t.size-t.selfLoopCount),i=O.getPointerArray(n),c=O.getPointerArray(t.order+1),f=e.getEdgeWeight?Float64Array:O.getPointerArray(2*t.size);this.C=t.order,this.M=0,this.E=n,this.U=0,this.resolution=s,this.level=0,this.graph=t,this.nodes=new Array(t.order),this.keepDendrogram=e.keepDendrogram,this.neighborhood=new c(n),this.weights=new f(n),this.loops=new f(t.order),this.starts=new i(t.order+1),this.offsets=new i(t.order),this.belongings=new c(t.order),this.dendrogram=[],this.counts=new c(t.order),this.unused=new c(t.order),this.totalInWeights=new f(t.order),this.totalOutWeights=new f(t.order);var g,E={},a=0,W=0,h=this;t.forEachNode(function(o){h.nodes[a]=o,E[o]=a,W+=t.outDegreeWithoutSelfLoops(o),h.starts[a]=W,W+=t.inDegreeWithoutSelfLoops(o),h.offsets[a]=W,h.belongings[a]=a,h.counts[a]=1,a++}),t.forEachEdge(function(o,j,m,A,y,w,C){if(g=r(o,j,m,A,y,w,C),m=E[m],A=E[A],h.M+=g,m===A)h.loops[m]+=g,h.totalInWeights[m]+=g,h.totalOutWeights[m]+=g;else{h.totalOutWeights[m]+=g,h.totalInWeights[A]+=g;var k=--h.starts[m],b=--h.offsets[A];h.neighborhood[k]=A,h.neighborhood[b]=m,h.weights[k]=g,h.weights[b]=g}}),this.starts[a]=this.E,this.keepDendrogram?this.dendrogram.push(this.belongings.slice()):this.mapping=this.belongings.slice()}d.prototype.isolate=function(t,e){var s=this.belongings[t];if(1===this.counts[s])return s;var r=this.unused[--this.U],n=this.loops[t];return this.totalWeights[s]-=e+n,this.totalWeights[r]+=e+n,this.belongings[t]=r,this.counts[s]--,this.counts[r]++,r},d.prototype.move=function(t,e,s){var r=this.belongings[t],n=this.loops[t];this.totalWeights[r]-=e+n,this.totalWeights[s]+=e+n,this.belongings[t]=s;var i=1==this.counts[r]--;this.counts[s]++,i&&(this.unused[this.U++]=r)},d.prototype.computeNodeDegree=function(t){var e,s,n=0;for(e=this.starts[t],s=this.starts[t+1];e<s;e++)n+=this.weights[e];return n},d.prototype.expensiveIsolate=function(t){var e=this.computeNodeDegree(t);return this.isolate(t,e)},d.prototype.expensiveMove=function(t,e){var s=this.computeNodeDegree(t);this.move(t,s,e)},d.prototype.zoomOut=function(){var i,c,f,E,g,a,W,h,o,j,m,t=new Array(this.C-this.U),e={},s=this.nodes.length,r=0,n=0;for(i=0,f=this.C;i<f;i++)(a=this.belongings[i])in e||(e[a]=r,t[r]={adj:{},totalWeights:this.totalWeights[a],internalWeights:0},r++),this.belongings[i]=e[a];if(this.keepDendrogram){for(j=this.dendrogram[this.level],m=new(O.getPointerArray(r))(s),i=0;i<s;i++)m[i]=this.belongings[j[i]];this.dendrogram.push(m)}else for(i=0;i<s;i++)this.mapping[i]=this.belongings[this.mapping[i]];for(i=0,f=this.C;i<f;i++)for(o=(h=t[a=this.belongings[i]]).adj,h.internalWeights+=this.loops[i],c=this.starts[i],E=this.starts[i+1];c<E;c++)a!==(W=this.belongings[g=this.neighborhood[c]])?(W in o||(o[W]=0),o[W]+=this.weights[c]):h.internalWeights+=this.weights[c];for(this.C=r,g=0,a=0;a<r;a++)for(W in o=(h=t[a]).adj,this.totalWeights[a=+a]=h.totalWeights,this.loops[a]=h.internalWeights,this.counts[a]=1,this.starts[a]=g,this.belongings[a]=a,o)this.neighborhood[g]=+W,this.weights[g]=o[W],n++,g++;return this.starts[r]=n,this.E=n,this.U=0,this.level++,e},d.prototype.modularity=function(){var t,s,r,n,i=0,c=2*this.M,f=new Float64Array(this.C);for(s=0;s<this.C;s++)for(f[t=this.belongings[s]]+=this.loops[s],r=this.starts[s],n=this.starts[s+1];r<n;r++)t===this.belongings[this.neighborhood[r]]&&(f[t]+=this.weights[r]);for(s=0;s<this.C;s++)i+=f[s]/c-Math.pow(this.totalWeights[s]/c,2)*this.resolution;return i},d.prototype.delta=function(t,e,s,r){var n=this.M;return s/n-this.totalWeights[r]*(e+=this.loops[t])*this.resolution/(2*n*n)},d.prototype.deltaWithOwnCommunity=function(t,e,s,r){var n=this.M;return s/n-(this.totalWeights[r]-(e+=this.loops[t]))*e*this.resolution/(2*n*n)},d.prototype.fastDelta=function(t,e,s,r){return s-(e+=this.loops[t])*this.totalWeights[r]*this.resolution/(2*this.M)},d.prototype.fastDeltaWithOwnCommunity=function(t,e,s,r){return s-(e+=this.loops[t])*(this.totalWeights[r]-e)*this.resolution/(2*this.M)},d.prototype.bounds=function(t){return[this.starts[t],this.starts[t+1]]},d.prototype.project=function(){var t=this,e={};return t.nodes.slice(0,this.C).forEach(function(s,r){e[s]=Array.from(t.neighborhood.slice(t.starts[r],t.starts[r+1])).map(function(n){return t.nodes[n]})}),e},d.prototype.collect=function(t){arguments.length<1&&(t=this.level);var r,n,e={},s=this.keepDendrogram?this.dendrogram[t]:this.mapping;for(r=0,n=s.length;r<n;r++)e[this.nodes[r]]=s[r];return e},d.prototype.assign=function(t,e){arguments.length<2&&(e=this.level);var r,n,s=this.keepDendrogram?this.dendrogram[e]:this.mapping;for(r=0,n=s.length;r<n;r++)this.graph.setNodeAttribute(this.nodes[r],t,s[r])},d.prototype[u]=function(){var t={};Object.defineProperty(t,"constructor",{value:d,enumerable:!1}),t.C=this.C,t.M=this.M,t.E=this.E,t.U=this.U,t.resolution=this.resolution,t.level=this.level,t.nodes=this.nodes,t.starts=this.starts.slice(0,t.C+1);var r=this;return["neighborhood","weights"].forEach(function(n){t[n]=r[n].slice(0,t.E)}),["counts","loops","belongings","totalWeights"].forEach(function(n){t[n]=r[n].slice(0,t.C)}),t.unused=this.unused.slice(0,this.U),this.keepDendrogram?t.dendrogram=this.dendrogram:t.mapping=this.mapping,t},v.prototype.bounds=d.prototype.bounds,v.prototype.inBounds=function(t){return[this.offsets[t],this.starts[t+1]]},v.prototype.outBounds=function(t){return[this.starts[t],this.offsets[t]]},v.prototype.project=d.prototype.project,v.prototype.projectIn=function(){var t=this,e={};return t.nodes.slice(0,this.C).forEach(function(s,r){e[s]=Array.from(t.neighborhood.slice(t.offsets[r],t.starts[r+1])).map(function(n){return t.nodes[n]})}),e},v.prototype.projectOut=function(){var t=this,e={};return t.nodes.slice(0,this.C).forEach(function(s,r){e[s]=Array.from(t.neighborhood.slice(t.starts[r],t.offsets[r])).map(function(n){return t.nodes[n]})}),e},v.prototype.isolate=function(t,e,s){var r=this.belongings[t];if(1===this.counts[r])return r;var n=this.unused[--this.U],i=this.loops[t];return this.totalInWeights[r]-=e+i,this.totalInWeights[n]+=e+i,this.totalOutWeights[r]-=s+i,this.totalOutWeights[n]+=s+i,this.belongings[t]=n,this.counts[r]--,this.counts[n]++,n},v.prototype.move=function(t,e,s,r){var n=this.belongings[t],i=this.loops[t];this.totalInWeights[n]-=e+i,this.totalInWeights[r]+=e+i,this.totalOutWeights[n]-=s+i,this.totalOutWeights[r]+=s+i,this.belongings[t]=r;var c=1==this.counts[n]--;this.counts[r]++,c&&(this.unused[this.U++]=n)},v.prototype.computeNodeInDegree=function(t){var e,s,n=0;for(e=this.offsets[t],s=this.starts[t+1];e<s;e++)n+=this.weights[e];return n},v.prototype.computeNodeOutDegree=function(t){var e,s,n=0;for(e=this.starts[t],s=this.offsets[t];e<s;e++)n+=this.weights[e];return n},v.prototype.expensiveMove=function(t,e){var s=this.computeNodeInDegree(t),r=this.computeNodeOutDegree(t);this.move(t,s,r,e)},v.prototype.zoomOut=function(){var i,c,f,E,g,a,W,h,o,j,m,A,y,w,C,t=new Array(this.C-this.U),e={},s=this.nodes.length,r=0,n=0;for(i=0,f=this.C;i<f;i++)(a=this.belongings[i])in e||(e[a]=r,t[r]={inAdj:{},outAdj:{},totalInWeights:this.totalInWeights[a],totalOutWeights:this.totalOutWeights[a],internalWeights:0},r++),this.belongings[i]=e[a];if(this.keepDendrogram){for(w=this.dendrogram[this.level],C=new(O.getPointerArray(r))(s),i=0;i<s;i++)C[i]=this.belongings[w[i]];this.dendrogram.push(C)}else for(i=0;i<s;i++)this.mapping[i]=this.belongings[this.mapping[i]];for(i=0,f=this.C;i<f;i++)for(o=this.offsets[i],A=(h=t[a=this.belongings[i]]).inAdj,y=h.outAdj,h.internalWeights+=this.loops[i],c=this.starts[i],E=this.starts[i+1];c<E;c++)m=(j=c<o)?y:A,a!==(W=this.belongings[g=this.neighborhood[c]])?(W in m||(m[W]=0),m[W]+=this.weights[c]):j&&(h.internalWeights+=this.weights[c]);for(this.C=r,g=0,a=0;a<r;a++){for(W in A=(h=t[a]).inAdj,y=h.outAdj,this.totalInWeights[a=+a]=h.totalInWeights,this.totalOutWeights[a]=h.totalOutWeights,this.loops[a]=h.internalWeights,this.counts[a]=1,this.starts[a]=g,this.belongings[a]=a,y)this.neighborhood[g]=+W,this.weights[g]=y[W],n++,g++;for(W in this.offsets[a]=g,A)this.neighborhood[g]=+W,this.weights[g]=A[W],n++,g++}return this.starts[r]=n,this.E=n,this.U=0,this.level++,e},v.prototype.modularity=function(){var t,s,r,n,i=0,c=this.M,f=new Float64Array(this.C);for(s=0;s<this.C;s++)for(f[t=this.belongings[s]]+=this.loops[s],r=this.starts[s],n=this.offsets[s];r<n;r++)t===this.belongings[this.neighborhood[r]]&&(f[t]+=this.weights[r]);for(s=0;s<this.C;s++)i+=f[s]/c-this.totalInWeights[s]*this.totalOutWeights[s]/Math.pow(c,2)*this.resolution;return i},v.prototype.delta=function(t,e,s,r,n){var i=this.M,E=this.loops[t];return r/i-((s+=E)*this.totalInWeights[n]+(e+=E)*this.totalOutWeights[n])*this.resolution/(i*i)},v.prototype.deltaWithOwnCommunity=function(t,e,s,r,n){var i=this.M,E=this.loops[t];return r/i-((s+=E)*(this.totalInWeights[n]-(e+=E))+e*(this.totalOutWeights[n]-s))*this.resolution/(i*i)},v.prototype.collect=d.prototype.collect,v.prototype.assign=d.prototype.assign,v.prototype[u]=function(){var t={};Object.defineProperty(t,"constructor",{value:v,enumerable:!1}),t.C=this.C,t.M=this.M,t.E=this.E,t.U=this.U,t.resolution=this.resolution,t.level=this.level,t.nodes=this.nodes,t.starts=this.starts.slice(0,t.C+1);var r=this;return["neighborhood","weights"].forEach(function(n){t[n]=r[n].slice(0,t.E)}),["counts","offsets","loops","belongings","totalInWeights","totalOutWeights"].forEach(function(n){t[n]=r[n].slice(0,t.C)}),t.unused=this.unused.slice(0,this.U),this.keepDendrogram?t.dendrogram=this.dendrogram:t.mapping=this.mapping,t},F.UndirectedLouvainIndex=d,F.DirectedLouvainIndex=v},5568:(G,F,x)=>{var O=x(6714);G.exports=function(p){if(!O(p))throw new Error("graphology-utils/infer-type: expecting a valid graphology instance.");var u=p.type;return"mixed"!==u?u:0===p.directedSize&&0===p.undirectedSize||p.directedSize>0&&p.undirectedSize>0?"mixed":p.directedSize>0?"directed":"undirected"}},8090:(G,F,x)=>{var O=x(5701),M=x(6116).getPointerArray;function p(u,l){arguments.length<2&&(l=u,u=Array);var d=M(l);this.size=0,this.length=l,this.dense=new d(l),this.sparse=new d(l),this.vals=new u(l)}p.prototype.clear=function(){this.size=0},p.prototype.has=function(u){var l=this.sparse[u];return l<this.size&&this.dense[l]===u},p.prototype.get=function(u){var l=this.sparse[u];if(l<this.size&&this.dense[l]===u)return this.vals[l]},p.prototype.set=function(u,l){var d=this.sparse[u];return d<this.size&&this.dense[d]===u?(this.vals[d]=l,this):(this.dense[this.size]=u,this.sparse[u]=this.size,this.vals[this.size]=l,this.size++,this)},p.prototype.delete=function(u){var l=this.sparse[u];return!(l>=this.size||this.dense[l]!==u||(this.dense[this.sparse[u]]=l=this.dense[this.size-1],this.sparse[l]=this.sparse[u],this.size--,0))},p.prototype.forEach=function(u,l){l=arguments.length>1?l:this;for(var d=0;d<this.size;d++)u.call(l,this.vals[d],this.dense[d])},p.prototype.keys=function(){var u=this.size,l=this.dense,d=0;return new O(function(){if(d<u){var v=l[d];return d++,{value:v}}return{done:!0}})},p.prototype.values=function(){var u=this.size,l=this.vals,d=0;return new O(function(){if(d<u){var v=l[d];return d++,{value:v}}return{done:!0}})},p.prototype.entries=function(){var u=this.size,l=this.dense,d=this.vals,v=0;return new O(function(){if(v<u){var t=[l[v],d[v]];return v++,{value:t}}return{done:!0}})},"undefined"!=typeof Symbol&&(p.prototype[Symbol.iterator]=p.prototype.entries),p.prototype.inspect=function(){for(var u=new Map,l=0;l<this.size;l++)u.set(this.dense[l],this.vals[l]);return Object.defineProperty(u,"constructor",{value:p,enumerable:!1}),u.length=this.length,this.vals.constructor!==Array&&(u.type=this.vals.constructor.name),u},"undefined"!=typeof Symbol&&(p.prototype[Symbol.for("nodejs.util.inspect.custom")]=p.prototype.inspect),G.exports=p},5766:(G,F,x)=>{var O=x(5701),M=x(6116).getPointerArray;function p(u){var l=M(u);this.start=0,this.size=0,this.capacity=u,this.dense=new l(u),this.sparse=new l(u)}p.prototype.clear=function(){this.start=0,this.size=0},p.prototype.has=function(u){if(0===this.size)return!1;var l=this.sparse[u];return(l<this.capacity&&l>=this.start&&l<this.start+this.size||l<(this.start+this.size)%this.capacity)&&this.dense[l]===u},p.prototype.enqueue=function(u){var l=this.sparse[u];return 0!==this.size&&(l<this.capacity&&l>=this.start&&l<this.start+this.size||l<(this.start+this.size)%this.capacity)&&this.dense[l]===u||(this.dense[l=(this.start+this.size)%this.capacity]=u,this.sparse[u]=l,this.size++),this},p.prototype.dequeue=function(){if(0!==this.size){var u=this.start;this.size--,this.start++,this.start===this.capacity&&(this.start=0);var l=this.dense[u];return this.sparse[l]=this.capacity,l}},p.prototype.forEach=function(u,l){l=arguments.length>1?l:this;for(var d=this.capacity,v=this.size,t=this.start,e=0;e<v;)u.call(l,this.dense[t],e,this),e++,++t===d&&(t=0)},p.prototype.values=function(){var u=this.dense,l=this.capacity,d=this.size,v=this.start,t=0;return new O(function(){if(t>=d)return{done:!0};var e=u[v];return v++,t++,v===l&&(v=0),{value:e,done:!1}})},"undefined"!=typeof Symbol&&(p.prototype[Symbol.iterator]=p.prototype.values),p.prototype.inspect=function(){var u=[];return this.forEach(function(l){u.push(l)}),Object.defineProperty(u,"constructor",{value:p,enumerable:!1}),u.capacity=this.capacity,u},"undefined"!=typeof Symbol&&(p.prototype[Symbol.for("nodejs.util.inspect.custom")]=p.prototype.inspect),G.exports=p},8859:G=>{function F(O){return function(M){return"number"!=typeof M&&(M=M.length),Math.floor(O()*M)}}var x=F(Math.random);x.createRandomIndex=F,G.exports=x}}]);